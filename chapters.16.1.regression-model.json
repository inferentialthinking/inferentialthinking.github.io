{"version":2,"kind":"Notebook","sha256":"fa6dcd4ad4df150daea01ae02990887a3644faf9e797133769847c80cb5f3a87","slug":"chapters.16.1.regression-model","location":"/chapters/16/1/Regression_Model.ipynb","dependencies":[],"frontmatter":{"title":"A Regression Model","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"license":{"content":{"id":"CC-BY-NC-ND-4.0","url":"https://creativecommons.org/licenses/by-nc-nd/4.0/","name":"Creative Commons Attribution Non Commercial No Derivatives 4.0 International","CC":true}},"github":"https://github.com/data-8/textbook","numbering":{"title":{"enabled":true,"offset":1}},"source_url":"https://github.com/data-8/textbook/blob/main/chapters/16/1/Regression_Model.ipynb","edit_url":"https://github.com/data-8/textbook/edit/main/chapters/16/1/Regression_Model.ipynb","enumerator":"16.1","exports":[{"format":"ipynb","filename":"Regression_Model.ipynb","url":"/build/Regression_Model-2ce233019dc08573a47a4f980b7d37e4.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In brief, such models say that the underlying relation between the two variables is perfectly linear; this straight line is the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kSz0NIlvM0"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"signal","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"TEXkmIhxzh"}],"key":"Yfv90h9fIU"},{"type":"text","value":" that we would like to identify. However, we are not able to see the line clearly. What we see are points that are scattered around the line. In each of the points, the signal has been contaminated by ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"aUlmguv74M"},{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"random noise","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J4N8Ygi9zA"}],"key":"ZbXzUWAqPt"},{"type":"text","value":". Our inferential goal, therefore, is to separate the signal from the noise.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Sxc1GEcfva"}],"key":"rntxefLfmA"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In greater detail, the regression model specifies that the points in the scatter plot are generated at random as follows.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BBQmk22g2Z"}],"key":"rHmY7UeKjz"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":7,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The relation between ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"sU524TUSFs"},{"type":"inlineMath","value":"x","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"uxQ2ObfISZ"},{"type":"text","value":" and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"NpsKW2BcXk"},{"type":"inlineMath","value":"y","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"WuS10XylSd"},{"type":"text","value":" is perfectly linear. We cannot see this “true line” but it exists.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ByntXxAeez"}],"key":"h18HP30dkz"}],"key":"oVNvcTBBNG"},{"type":"listItem","spread":true,"position":{"start":{"line":8,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The scatter plot is created by taking points on the line and pushing them off the line vertically, either above or below, as follows:","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vMONqGkqEq"}],"key":"wY2GQdJcES"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":9,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"For each ","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"cuiZN0NR4D"},{"type":"inlineMath","value":"x","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"p8zGKpJC4z"},{"type":"text","value":", find the corresponding point on the true line (that’s the signal), and then generate the noise or error.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"qa3mqGxZ3h"}],"key":"OLt7HoTi55"}],"key":"DRhthrZdLq"},{"type":"listItem","spread":true,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The errors are drawn at random with replacement from a population of errors that has a normal distribution with mean 0.","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"BKJcDVRAT8"}],"key":"EpkDEyrpX4"}],"key":"Yd3vXppaZg"},{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Create a point whose horizontal coordinate is ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"WWWortY7cv"},{"type":"inlineMath","value":"x","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"X9grGNkAih"},{"type":"text","value":" and whose vertical coordinate is “the height of the true line at ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"NBl1rhGuiU"},{"type":"inlineMath","value":"x","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"qthueHOkwm"},{"type":"text","value":", plus the error”.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"bmr5ELMe6E"}],"key":"w2lNAnbcuR"}],"key":"I6b6tONBxZ"}],"key":"JMoxoLqdHs"}],"key":"C6o27XzCVQ"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Finally, erase the true line from the scatter, and display just the points created.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"iiMwbTNsiQ"}],"key":"gImFjeKnZ4"}],"key":"h2eGTZ4Hbr"}],"key":"nw2tuwd4ce"}],"key":"pCJwMNn44Z"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from datascience import *\npath_data = '../../../assets/data/'\nimport numpy as np\nimport matplotlib\nmatplotlib.use('Agg')\n%matplotlib inline\nimport matplotlib.pyplot as plots\nplots.style.use('fivethirtyeight')","visibility":"remove","key":"EVIpjRqWpq"},{"type":"output","id":"wEXRNbovzLv8DyBaB7vBA","data":[],"visibility":"show","key":"vMnUZbMvop"}],"visibility":"show","key":"OEWFd18uNt"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def standard_units(any_numbers):\n    \"Convert any array of numbers to standard units.\"\n    return (any_numbers - np.mean(any_numbers))/np.std(any_numbers)  \n\ndef correlation(t, x, y):\n    return np.mean(standard_units(t.column(x))*standard_units(t.column(y)))\n\ndef slope(table, x, y):\n    r = correlation(table, x, y)\n    return r * np.std(table.column(y))/np.std(table.column(x))\n\ndef intercept(table, x, y):\n    a = slope(table, x, y)\n    return np.mean(table.column(y)) - a * np.mean(table.column(x))\n\ndef fit(table, x, y):\n    a = slope(table, x, y)\n    b = intercept(table, x, y)\n    return a * table.column(x) + b\n\ndef scatter_fit(table, x, y):\n    plots.scatter(table.column(x), table.column(y), s=20)\n    plots.plot(table.column(x), fit(table, x, y), lw=2, color='gold')\n    plots.xlabel(x)\n    plots.ylabel(y)","visibility":"remove","key":"Kk2GkNIXVq"},{"type":"output","id":"-5yyVIZoM-QpKSVBvzqoB","data":[],"visibility":"show","key":"ypIDrqNaI3"}],"visibility":"show","key":"hCH1VPD1lJ"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Based on this scatter plot, how should we estimate the true line? The best line that we can put through a scatter plot is the regression line. So the regression line is a natural estimate of the true line.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GEnBZ3rd5z"}],"key":"q8fCweX5Xa"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"The simulation below shows how close the regression line is to the true line. The first panel shows how the scatter plot is generated from the true line. The second shows the scatter plot that we see. The third shows the regression line through the plot. The fourth shows both the regression line and the true line.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"RSRfNAqxbU"}],"key":"Z5WhCnocdS"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To run the simulation, call the function ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uha87mdvJk"},{"type":"inlineCode","value":"draw_and_compare","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"CaRRBZbhdC"},{"type":"text","value":" with three arguments: the slope of the true line, the intercept of the true line, and the sample size.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"bHdDoCXh2m"}],"key":"zq3LXt4cX8"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Run the simulation a few times, with different values for the slope and intercept of the true line, and varying sample sizes. Because all the points are generated according to the model, you will see that the regression line is a good estimate of the true line if the sample size is moderately large.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"FujEiU0lnr"}],"key":"YtN8GopSwG"}],"key":"vYuVgez2Dm"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def draw_and_compare(true_slope, true_int, sample_size):\n    x = np.random.normal(50, 5, sample_size)\n    xlims = np.array([np.min(x), np.max(x)])\n    eps = np.random.normal(0, 6, sample_size)\n    y = (true_slope*x + true_int) + eps\n    tyche = Table().with_columns(\n        'x', x,\n        'y', y\n    )\n\n    plots.figure(figsize=(6, 16))\n    plots.subplot(4, 1, 1)\n    plots.scatter(tyche['x'], tyche['y'], s=20)\n    plots.plot(xlims, true_slope*xlims + true_int, lw=2, color='green')\n    plots.title('True Line, and Points Created')\n\n    plots.subplot(4, 1, 2)\n    plots.scatter(tyche['x'],tyche['y'], s=20)\n    plots.title('What We Get to See')\n\n    plots.subplot(4, 1, 3)\n    scatter_fit(tyche, 'x', 'y')\n    plots.xlabel(\"\")\n    plots.ylabel(\"\")\n    plots.title('Regression Line: Estimate of True Line')\n\n    plots.subplot(4, 1, 4)\n    scatter_fit(tyche, 'x', 'y')\n    plots.ylabel(\"\")\n    xlims = np.array([np.min(tyche['x']), np.max(tyche['x'])])\n    plots.plot(xlims, true_slope*xlims + true_int, lw=2, color='green')\n    plots.title(\"Regression Line and True Line\")","visibility":"remove","key":"tQVsORNlY5"},{"type":"output","id":"pkCg-se9MNq_NvUBKJNGx","data":[],"visibility":"show","key":"TaFX3kkLBz"}],"visibility":"show","key":"sGsqLc6wYv"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# The true line,\n# the points created,\n# and our estimate of the true line.\n# Arguments: true slope, true intercept, number of points\n\ndraw_and_compare(4, -5, 10)","key":"c5urLa1myg"},{"type":"output","id":"CvO0oVfQWqawrBdHF6JuC","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"eb8c16ddd65b7f26742d3beb2414dd31","path":"/build/eb8c16ddd65b7f26742d3beb2414dd31.png"},"text/plain":{"content":"<Figure size 432x1152 with 4 Axes>","content_type":"text/plain"}}}],"key":"qGViTObIpI"}],"key":"m6WGoYMcz1"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"In reality, of course, we will never see the true line. What the simulation shows that if the regression model looks plausible, and if we have a large sample, then the regression line is a good approximation to the true line.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"qVbpIw0VAB"}],"key":"saeA530tw3"}],"key":"lF3kh9FRHC"}],"key":"Is9ti4OzJx"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Inference for Regression","url":"/chapters/16/inference-for-regression","group":"Computational and Inferential Thinking"},"next":{"title":"Inference for the True Slope","url":"/chapters/16/2/inference-for-the-true-slope","group":"Computational and Inferential Thinking"}}},"domain":"http://localhost:3000"}