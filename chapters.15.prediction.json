{"version":2,"kind":"Notebook","sha256":"937eda3012e8c6944f1440ba94f6c41cce4ecca45d2bdfa3cb2d2bd25d5f3542","slug":"chapters.15.prediction","location":"/chapters/15/Prediction.ipynb","dependencies":[],"frontmatter":{"title":"Prediction","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"license":{"content":{"id":"CC-BY-NC-ND-4.0","url":"https://creativecommons.org/licenses/by-nc-nd/4.0/","name":"Creative Commons Attribution Non Commercial No Derivatives 4.0 International","CC":true}},"github":"https://github.com/data-8/textbook","numbering":{"title":{"enabled":true}},"source_url":"https://github.com/data-8/textbook/blob/main/chapters/15/Prediction.ipynb","edit_url":"https://github.com/data-8/textbook/edit/main/chapters/15/Prediction.ipynb","enumerator":"15","exports":[{"format":"ipynb","filename":"Prediction.ipynb","url":"/build/Prediction-0f74a2c81efdb2b90997ee983dde25f5.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"An important aspect of data science is to find out what data can tell us about the future. What do data about climate and pollution say about temperatures a few decades from now? Based on a person’s internet profile, which websites are likely to interest them? How can a patient’s medical history be used to judge how well he or she will respond to a treatment?","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QkVu4GwRh1"}],"key":"oQai8XZHGm"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"To answer such questions, data scientists have developed methods for making ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"D06vVtPCJN"},{"type":"emphasis","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"predictions","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"VsJ5JG3z4K"}],"key":"GlKKkJmex7"},{"type":"text","value":". In this chapter we will study one of the most commonly used ways of predicting the value of one variable based on the value of another.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"m5BQB2Ekkc"}],"key":"dgMQSzfpgj"}],"key":"nGVsPr3s5f"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from datascience import *\nimport matplotlib\npath_data = '../../assets/data/'\nmatplotlib.use('Agg')\n%matplotlib inline\nimport matplotlib.pyplot as plots\nplots.style.use('fivethirtyeight')\nimport numpy as np","visibility":"remove","key":"QSIWHGDstx"},{"type":"output","id":"1NOVcv4X9_Qq75WWa8urn","data":[],"visibility":"show","key":"H3NZrZO58o"}],"visibility":"show","key":"DxKqY9NMdz"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here is a historical dataset used for the prediction of the heights of adults based on the heights of their parents. We have studied this dataset in an earlier section. The table ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"xuKs4Ym2cy"},{"type":"inlineCode","value":"heights","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"CKYVPtuU7D"},{"type":"text","value":" contains data on the midparent height and child’s height (all in inches) for a population of 934 adult “children”. Recall that the midparent height is an average of the heights of the two parents.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"kX8LNVGDpR"}],"key":"PN31jkGL6h"}],"key":"HHT0jO7OX6"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Data on heights of parents and their adult children\noriginal = Table.read_table(path_data + 'family_heights.csv')\nheights = Table().with_columns(\n    'MidParent', original.column('midparentHeight'),\n    'Child', original.column('childHeight')\n    )","key":"iVVvnIXyyH"},{"type":"output","id":"jWqdP9wdZp6U5PPlyOMKn","data":[],"key":"zbvxlZIBI5"}],"key":"gTIiQIaFSx"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"heights","key":"G0fOpoad5u"},{"type":"output","id":"B2cB8YwMhxjKAw_aX2PLW","data":[{"output_type":"execute_result","execution_count":3,"metadata":{},"data":{"text/html":{"content":"<table border=\"1\" class=\"dataframe\">\n    <thead>\n        <tr>\n            <th>MidParent</th> <th>Child</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>75.43    </td> <td>73.2 </td>\n        </tr>\n        <tr>\n            <td>75.43    </td> <td>69.2 </td>\n        </tr>\n        <tr>\n            <td>75.43    </td> <td>69   </td>\n        </tr>\n        <tr>\n            <td>75.43    </td> <td>69   </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>73.5 </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>72.5 </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>65.5 </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>65.5 </td>\n        </tr>\n        <tr>\n            <td>72.06    </td> <td>71   </td>\n        </tr>\n        <tr>\n            <td>72.06    </td> <td>68   </td>\n        </tr>\n    </tbody>\n</table>\n<p>... (924 rows omitted)</p>","content_type":"text/html"},"text/plain":{"content":"MidParent | Child\n75.43     | 73.2\n75.43     | 69.2\n75.43     | 69\n75.43     | 69\n73.66     | 73.5\n73.66     | 72.5\n73.66     | 65.5\n73.66     | 65.5\n72.06     | 71\n72.06     | 68\n... (924 rows omitted)","content_type":"text/plain"}}}],"key":"GWaWUkKWcu"}],"key":"qcYGmD3AXW"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"heights.scatter('MidParent')","key":"AjG9816enf"},{"type":"output","id":"USOyg2-3v7x21CBQi68pB","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"fef955240742b7007dc41c38e3ffd527","path":"/build/fef955240742b7007dc41c38e3ffd527.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"oIZ44YYiQr"}],"key":"Ait3j6tHmi"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A primary reason for studying the data was to be able to predict the adult height of a child born to parents who were similar to those in the dataset. We made these predictions in Section 8.1, after noticing the positive association between the two variables.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"vjVMnh864w"}],"key":"q6vlK1oyM1"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Our approach was to base the prediction on all the points that correspond to a midparent height of around the midparent height of the new person. To do this, we wrote a function called ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"APm6wuYzwp"},{"type":"inlineCode","value":"predict_child","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HhsCjahNy4"},{"type":"text","value":" which takes a midparent height as its argument and returns the average height of all the children who had midparent heights within half an inch of the argument.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"sKb16jtHb1"}],"key":"MlaBtl1hD4"}],"key":"m0MMT6CxiD"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def predict_child(mpht):\n    \"\"\"Return a prediction of the height of a child \n    whose parents have a midparent height of mpht.\n    \n    The prediction is the average height of the children \n    whose midparent height is in the range mpht plus or minus 0.5 inches.\n    \"\"\"\n    \n    close_points = heights.where('MidParent', are.between(mpht-0.5, mpht + 0.5))\n    return close_points.column('Child').mean()                       ","key":"nZwdBPhRt5"},{"type":"output","id":"v3YA-SJavSTiLIBYsQnqE","data":[],"key":"A0d4pEiztE"}],"key":"mS6MLNTb7J"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We applied the function to the column of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FngGNdHl0Y"},{"type":"inlineCode","value":"Midparent","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"yJrm6z2Lsz"},{"type":"text","value":" heights, and visualized the result.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"H1vFqIeAfM"}],"key":"OvtfwVoXLy"}],"key":"vaVSu0oa6O"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Apply predict_child to all the midparent heights\n\nheights_with_predictions = heights.with_column(\n    'Prediction', heights.apply(predict_child, 'MidParent')\n    )","key":"aegm0pDvHV"},{"type":"output","id":"CQA42v0sVvAjBYm29fkxK","data":[],"key":"YiNISFav6p"}],"key":"dpkb67EbfZ"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"# Draw the original scatter plot along with the predicted values\n\nheights_with_predictions.scatter('MidParent')","key":"LyWfxzp7AT"},{"type":"output","id":"T2ju2kQlka3EdHPpTUR-K","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"256d04b68fd6922cfc800a4522b0eb9d","path":"/build/256d04b68fd6922cfc800a4522b0eb9d.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"japIdzr3Rq"}],"key":"sov9WdKbDF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The prediction at a given midparent height lies roughly at the center of the vertical strip of points at the given height. This method of prediction is called ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"OzgIceTU8m"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"regression.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"c1ilKxNWsI"}],"key":"WHJUlB8d8F"},{"type":"text","value":" Later in this chapter we will see whether we can avoid our arbitrary definitions of “closeness” being “within 0.5 inches”. But first we will develop a measure that can be used in many settings to decide how good one variable will be as a predictor of another.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"t1Liz3YNfc"}],"key":"rBxvSV6YdF"}],"key":"O3ymD5UL4h"}],"key":"fPz30LzU4b"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Choosing a Sample Size","url":"/chapters/14/6/choosing-a-sample-size","group":"Computational and Inferential Thinking"},"next":{"title":"Correlation","url":"/chapters/15/1/correlation","group":"Computational and Inferential Thinking"}}},"domain":"http://localhost:3000"}