{"version":2,"kind":"Notebook","sha256":"e3527e29d7653ba73ed0f9bf34ec6018a6e536442fcba055789a703ee9b04e30","slug":"chapters.15.5.visual-diagnostics","location":"/chapters/15/5/Visual_Diagnostics.ipynb","dependencies":[],"frontmatter":{"title":"Visual Diagnostics","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"license":{"content":{"id":"CC-BY-NC-ND-4.0","url":"https://creativecommons.org/licenses/by-nc-nd/4.0/","name":"Creative Commons Attribution Non Commercial No Derivatives 4.0 International","CC":true}},"github":"https://github.com/data-8/textbook","numbering":{"title":{"enabled":true,"offset":1}},"source_url":"https://github.com/data-8/textbook/blob/main/chapters/15/5/Visual_Diagnostics.ipynb","edit_url":"https://github.com/data-8/textbook/edit/main/chapters/15/5/Visual_Diagnostics.ipynb","enumerator":"15.5","thumbnail":"/build/5f819b0045c6e81a4265dd506d7aaff9.jpeg","exports":[{"format":"ipynb","filename":"Visual_Diagnostics.ipynb","url":"/build/Visual_Diagnostics-fa697cb9248f27a4c425400d88f231fb.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Suppose a data scientist has decided to use linear regression to estimate values of one variable (called the response variable) based on another variable (called the predictor). To see how well this method of estimation performs, the data scientist must measure how far off the estimates are from the actual values. These differences are called ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"sBAUxub7BK"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"residuals","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oCVpaO84Lj"}],"key":"hCTet6ZowR"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"MfYiJQMRAF"}],"key":"wcq0mlvTTP"},{"type":"math","value":"\\mbox{residual} ~=~ \\mbox{observed value} ~-~ \\mbox{regression estimate}","position":{"start":{"line":4,"column":1},"end":{"line":6,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>residual </mtext><mo>=</mo><mtext> observed value </mtext><mo>−</mo><mtext> regression estimate</mtext></mrow><annotation encoding=\"application/x-tex\">\\mbox{residual} ~=~ \\mbox{observed value} ~-~ \\mbox{regression estimate}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord text\"><span class=\"mord\">observed value</span></span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\">regression estimate</span></span></span></span></span></span>","enumerator":"1","key":"ks4ix0uGBU"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"A residual is what’s left over – the residue – after estimation.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"vAo2JSDyWb"}],"key":"QESXFuBoeo"},{"type":"paragraph","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Residuals are the vertical distances of the points from the regression line. There is one residual for each point in the scatter plot. The residual is the difference between the observed value of ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AF43edSl14"},{"type":"inlineMath","value":"y","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"FwXcKOtUIE"},{"type":"text","value":" and the fitted value of ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"LxZb8Rgn0c"},{"type":"inlineMath","value":"y","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>y</mi></mrow><annotation encoding=\"application/x-tex\">y</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.625em;vertical-align:-0.1944em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span>","key":"B7Sbre0XFN"},{"type":"text","value":", so for the point ","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"wNjNZT8QMX"},{"type":"inlineMath","value":"(x, y)","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mo stretchy=\"false\">(</mo><mi>x</mi><mo separator=\"true\">,</mo><mi>y</mi><mo stretchy=\"false\">)</mo></mrow><annotation encoding=\"application/x-tex\">(x, y)</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1em;vertical-align:-0.25em;\"></span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mpunct\">,</span><span class=\"mspace\" style=\"margin-right:0.1667em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mclose\">)</span></span></span></span>","key":"XmjFcRsTAr"},{"type":"text","value":",","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"DCCnm58BzG"}],"key":"gCtzQdzlXT"},{"type":"math","value":"\\mbox{residual} ~~ = ~~ y ~-~\n\\mbox{fitted value of }y\n~~ = ~~ y ~-~\n\\mbox{height of regression line at }x","position":{"start":{"line":12,"column":1},"end":{"line":17,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>residual  </mtext><mo>=</mo><mtext>  </mtext><mi>y</mi><mtext> </mtext><mo>−</mo><mtext> fitted value of </mtext><mi>y</mi><mtext>  </mtext><mo>=</mo><mtext>  </mtext><mi>y</mi><mtext> </mtext><mo>−</mo><mtext> height of regression line at </mtext><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\mbox{residual} ~~ = ~~ y ~-~\n\\mbox{fitted value of }y\n~~ = ~~ y ~-~\n\\mbox{height of regression line at }x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">residual</span></span><span class=\"mspace nobreak\"> </span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace nobreak\"> </span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\">fitted value of </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace nobreak\"> </span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace nobreak\"> </span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\">height of regression line at </span></span><span class=\"mord mathnormal\">x</span></span></span></span></span>","enumerator":"2","key":"uq3JDC7WUp"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"The function ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"iHJFRn14Zp"},{"type":"inlineCode","value":"residual","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"tSncfvtowp"},{"type":"text","value":" calculates the residuals. The calculation assumes all the relevant functions we have already defined: ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"L6fPguTxKt"},{"type":"inlineCode","value":"standard_units","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KNSWwqYLbv"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"hxP6aVrxfa"},{"type":"inlineCode","value":"correlation","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"wefJ5YXLur"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"ycrsO0ArGd"},{"type":"inlineCode","value":"slope","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"l16GBKSs9A"},{"type":"text","value":", ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"dsHBbmUZNd"},{"type":"inlineCode","value":"intercept","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IulCoQEVED"},{"type":"text","value":", and ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"UCiYVsmBAG"},{"type":"inlineCode","value":"fit","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"J8kft75thf"},{"type":"text","value":".","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Pw0pgE0HJU"}],"key":"X6OubbnQqq"}],"key":"TvJQl9fiia"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from datascience import *\npath_data = '../../../assets/data/'\nimport numpy as np\nfrom scipy import stats\n\nimport matplotlib\nmatplotlib.use('Agg')\n%matplotlib inline\nimport matplotlib.pyplot as plots\nplots.style.use('fivethirtyeight')","visibility":"remove","key":"ZtMIf5M9rf"},{"type":"output","id":"P-_0fEDIR9DQslq3Ne0im","data":[],"visibility":"show","key":"Du6lbKinfq"}],"visibility":"show","key":"xpCbnD0o4H"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"family_heights = Table.read_table(path_data + 'family_heights.csv')\nheights = family_heights.select('midparentHeight', 'childHeight')\nheights = heights.relabel(0, 'MidParent').relabel(1, 'Child')\nhybrid = Table.read_table(path_data + 'hybrid.csv')","visibility":"show","key":"lHQcGy4fQq"},{"type":"output","id":"c3nyZLDuv8Rqam9C7DZg5","data":[],"visibility":"show","key":"UyIg7JRI6P"}],"visibility":"remove","key":"Tq7etzqIzO"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def standard_units(x):\n    return (x - np.mean(x))/np.std(x)\n\ndef correlation(table, x, y):\n    x_in_standard_units = standard_units(table.column(x))\n    y_in_standard_units = standard_units(table.column(y))\n    return np.mean(x_in_standard_units * y_in_standard_units)\n\ndef slope(table, x, y):\n    r = correlation(table, x, y)\n    return r * np.std(table.column(y))/np.std(table.column(x))\n\ndef intercept(table, x, y):\n    a = slope(table, x, y)\n    return np.mean(table.column(y)) -  a * np.mean(table.column(x))\n\ndef fit(table, x, y):\n    a = slope(table, x, y)\n    b = intercept(table, x, y)\n    return a * table.column(x) + b","visibility":"remove","key":"EP7EHvMiIf"},{"type":"output","id":"m9T1T7Ts9veH0A0DMG5Ns","data":[],"visibility":"show","key":"Grp3oo6S3u"}],"visibility":"show","key":"VC4Bj4Ey53"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def residual(table, x, y):\n    return table.column(y) - fit(table, x, y)","key":"QlNUAvPayQ"},{"type":"output","id":"8Bb5bToEkl7vm4eXAFw7y","data":[],"key":"j7pDWoUafY"}],"key":"B8p82XpLvj"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Continuing our example of estimating the heights of adult children (the response) based on the midparent height (the predictor), let us calculate the fitted values and the residuals.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"dW54pN3foQ"}],"key":"obd6tmynzx"}],"key":"BQg3okuNng"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"heights = heights.with_columns(\n        'Fitted Value', fit(heights, 'MidParent', 'Child'),\n        'Residual', residual(heights, 'MidParent', 'Child')\n    )\nheights","key":"zpKxWX3W0V"},{"type":"output","id":"c_r9PUpA6eDaTjpq3GJ6k","data":[{"output_type":"execute_result","execution_count":5,"metadata":{},"data":{"text/html":{"content":"<table border=\"1\" class=\"dataframe\">\n    <thead>\n        <tr>\n            <th>MidParent</th> <th>Child</th> <th>Fitted Value</th> <th>Residual</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>75.43    </td> <td>73.2 </td> <td>70.7124     </td> <td>2.48763  </td>\n        </tr>\n        <tr>\n            <td>75.43    </td> <td>69.2 </td> <td>70.7124     </td> <td>-1.51237 </td>\n        </tr>\n        <tr>\n            <td>75.43    </td> <td>69   </td> <td>70.7124     </td> <td>-1.71237 </td>\n        </tr>\n        <tr>\n            <td>75.43    </td> <td>69   </td> <td>70.7124     </td> <td>-1.71237 </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>73.5 </td> <td>69.5842     </td> <td>3.91576  </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>72.5 </td> <td>69.5842     </td> <td>2.91576  </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>65.5 </td> <td>69.5842     </td> <td>-4.08424 </td>\n        </tr>\n        <tr>\n            <td>73.66    </td> <td>65.5 </td> <td>69.5842     </td> <td>-4.08424 </td>\n        </tr>\n        <tr>\n            <td>72.06    </td> <td>71   </td> <td>68.5645     </td> <td>2.43553  </td>\n        </tr>\n        <tr>\n            <td>72.06    </td> <td>68   </td> <td>68.5645     </td> <td>-0.564467</td>\n        </tr>\n    </tbody>\n</table>\n<p>... (924 rows omitted)</p>","content_type":"text/html"},"text/plain":{"content":"MidParent | Child | Fitted Value | Residual\n75.43     | 73.2  | 70.7124      | 2.48763\n75.43     | 69.2  | 70.7124      | -1.51237\n75.43     | 69    | 70.7124      | -1.71237\n75.43     | 69    | 70.7124      | -1.71237\n73.66     | 73.5  | 69.5842      | 3.91576\n73.66     | 72.5  | 69.5842      | 2.91576\n73.66     | 65.5  | 69.5842      | -4.08424\n73.66     | 65.5  | 69.5842      | -4.08424\n72.06     | 71    | 68.5645      | 2.43553\n72.06     | 68    | 68.5645      | -0.564467\n... (924 rows omitted)","content_type":"text/plain"}}}],"key":"ue89oOgufN"}],"key":"msCS8bdDjx"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"When there are so many variables to work with, it is always helpful to start with visualization. The function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"D8NsKfIAir"},{"type":"inlineCode","value":"scatter_fit","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"y5iC3wGFhj"},{"type":"text","value":" draws the scatter plot of the data, as well as the regression line.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"FaOGKPI3Hd"}],"key":"ivugesuGfx"}],"key":"U6G4d6Lx1L"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def scatter_fit(table, x, y):\n    table.scatter(x, y, s=15)\n    plots.plot(table.column(x), fit(table, x, y), lw=4, color='gold')\n    plots.xlabel(x)\n    plots.ylabel(y)","key":"bnh3noOUGm"},{"type":"output","id":"9xJ3NYaGe2UDVfcKRL5A4","data":[],"key":"NSgav0pdlE"}],"key":"nq2sW9LVN4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"scatter_fit(heights, 'MidParent', 'Child')","key":"feDdaHf314"},{"type":"output","id":"OwDmA-jvNOu6HgkMQeSiR","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2b8f3419c792c747263781c3ac8898ff","path":"/build/2b8f3419c792c747263781c3ac8898ff.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"XCi62MAa4I"}],"key":"mr0kONy8n9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"A ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XKNwVSAawM"},{"type":"emphasis","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"residual plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"rdbrrCHtH6"}],"key":"CSchPDGksP"},{"type":"text","value":" can be drawn by plotting the residuals against the predictor variable. The function ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"QIyN5hPabl"},{"type":"inlineCode","value":"residual_plot","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"HvPsEsx353"},{"type":"text","value":" does just that.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"p3Qky3rYAE"}],"key":"UgbifcdwSV"}],"key":"uG8DUb0bN5"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def residual_plot(table, x, y):\n    x_array = table.column(x)\n    t = Table().with_columns(\n            x, x_array,\n            'residuals', residual(table, x, y)\n        )\n    t.scatter(x, 'residuals', color='r')\n    xlims = make_array(min(x_array), max(x_array))\n    plots.plot(xlims, make_array(0, 0), color='darkblue', lw=4)\n    plots.title('Residual Plot')","key":"vzEqKUQKiR"},{"type":"output","id":"dP_3q6VVeiqSYEjCWv-HC","data":[],"key":"IH0aDICudG"}],"key":"CgwEWSHZYj"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"residual_plot(heights, 'MidParent', 'Child')","key":"eRiKhb7iJD"},{"type":"output","id":"mFPdrSSQ0D-Ae6tWMQjSn","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"828cd5cacae05c28668c0057e3d8bc5c","path":"/build/828cd5cacae05c28668c0057e3d8bc5c.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"gSxYyXgVj0"}],"key":"ARpoDQUTlr"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"The midparent heights are on the horizontal axis, as in the original scatter plot. But now the vertical axis shows the residuals. Notice that the plot appears to be centered around the horizontal line at the level 0 (shown in dark blue). Notice also that the plot shows no upward or downward trend. We will observe later that this lack of trend is true of all regressions.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jwvI5LJPqQ"}],"key":"AnR8kZkU6e"}],"key":"EalgCYXAsK"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Regression Diagnostics","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"XogxlkO6Fu"}],"identifier":"regression-diagnostics","label":"Regression Diagnostics","html_id":"regression-diagnostics","implicit":true,"key":"EWc4aQbNeL"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Residual plots help us make visual assessments of the quality of a linear regression analysis. Such assessments are called ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"lXLknRpiaO"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"diagnostics","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"GXjvTqQVxk"}],"key":"QVNUYnXTdW"},{"type":"text","value":". The function ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oRB7rEPGdJ"},{"type":"inlineCode","value":"regression_diagnostic_plots","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"qwS4iKyg8t"},{"type":"text","value":" draws the original scatter plot as well as the residual plot for ease of comparison.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Vl7AWjlhLt"}],"key":"hSmHCz2M1M"}],"key":"Gn5PdONZ98"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def regression_diagnostic_plots(table, x, y):\n    scatter_fit(table, x, y)\n    residual_plot(table, x, y)","key":"k0pOGOswmH"},{"type":"output","id":"TyAQ-7Re6RvnM7nHUsROt","data":[],"key":"hzJu81mtGf"}],"key":"g7y4BNxHXr"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"regression_diagnostic_plots(heights, 'MidParent', 'Child')","key":"hF3AnFUJUA"},{"type":"output","id":"Q3i1DA5qVdGhKjQw_l5gc","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"2b8f3419c792c747263781c3ac8898ff","path":"/build/2b8f3419c792c747263781c3ac8898ff.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"828cd5cacae05c28668c0057e3d8bc5c","path":"/build/828cd5cacae05c28668c0057e3d8bc5c.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"dKT2TNuCyI"}],"key":"Mdr3HY4G6p"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"This residual plot indicates that linear regression was a reasonable method of estimation. Notice how the residuals are distributed fairly symmetrically above and below the horizontal line at 0, corresponding to the original scatter plot being roughly symmetrical above and below. Notice also that the vertical spread of the plot is fairly even across the most common values of the children’s heights. In other words, apart from a few outlying points, the plot isn’t narrower in some places and wider in others.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GrWAsQg1TF"}],"key":"oQPhBUJGK5"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"In other words, the accuracy of the regression appears to be about the same across the observed range of the predictor variable.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"atzdNvkwJx"}],"key":"gKxZwX4tXe"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"The residual plot of a good regression shows no pattern. The residuals look about the same, above and below the horizontal line at 0, across the range of the predictor variable.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"roVmzIho7c"}],"key":"Io3voYTeiu"}],"key":"ySxqxq7avj"}],"key":"E9Cz6O8gym"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Detecting Nonlinearity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"GETyRAIwjw"}],"identifier":"detecting-nonlinearity","label":"Detecting Nonlinearity","html_id":"detecting-nonlinearity","implicit":true,"key":"YhjzpXvr9O"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"Drawing the scatter plot of the data usually gives an indication of whether the relation between the two variables is non-linear. Often, however, it is easier to spot non-linearity in a residual plot than in the original scatter plot. This is usually because of the scales of the two plots: the residual plot allows us to zoom in on the errors and hence makes it easier to spot patterns.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"toFKFHxej6"}],"key":"twIJyt1T58"}],"key":"pHhw46AqYb"},{"type":"block","kind":"notebook-content","children":[{"type":"image","url":"/build/5f819b0045c6e81a4265dd506d7aaff9.jpeg","key":"Hl9SHNbp2y","urlSource":"https://upload.wikimedia.org/wikipedia/commons/7/75/Dugong_dugon.jpg"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Our data are a ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"uFHoGjBFv2"},{"type":"link","url":"http://www.statsci.org/data/oz/dugongs.html","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"dataset","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"UuOuV6BVsK"}],"urlSource":"http://www.statsci.org/data/oz/dugongs.html","key":"BGe8OvucuH"},{"type":"text","value":"  on the age and length of dugongs, which are marine mammals related to manatees and sea cows (image from ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"lK9s4Eu9Uz"},{"type":"link","url":"https://commons.wikimedia.org/wiki/File:Dugong_dugon.jpg","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Wikimedia Commons","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"byWY2WHyBY"}],"urlSource":"https://commons.wikimedia.org/wiki/File:Dugong_dugon.jpg","key":"p9x7aysUPH"},{"type":"text","value":"). The data are in a table called ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"O3XPSHruux"},{"type":"inlineCode","value":"dugong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"b4iGJj5r8y"},{"type":"text","value":". Age is measured in years and length in meters. Because dugongs tend not to keep track of their birthdays, ages are estimated based on variables such as the condition of their teeth.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"D17MzoNQIv"}],"key":"cNGZEaTDnb"}],"key":"ZVD2WkySbh"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"dugong = Table.read_table(path_data + 'dugongs.csv')\ndugong = dugong.move_to_start('Length')\ndugong","key":"lkD3xw8w3j"},{"type":"output","id":"6up-A1awk_SXyWnJW5mc7","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/html":{"content":"<table border=\"1\" class=\"dataframe\">\n    <thead>\n        <tr>\n            <th>Length</th> <th>Age</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>1.8   </td> <td>1   </td>\n        </tr>\n        <tr>\n            <td>1.85  </td> <td>1.5 </td>\n        </tr>\n        <tr>\n            <td>1.87  </td> <td>1.5 </td>\n        </tr>\n        <tr>\n            <td>1.77  </td> <td>1.5 </td>\n        </tr>\n        <tr>\n            <td>2.02  </td> <td>2.5 </td>\n        </tr>\n        <tr>\n            <td>2.27  </td> <td>4   </td>\n        </tr>\n        <tr>\n            <td>2.15  </td> <td>5   </td>\n        </tr>\n        <tr>\n            <td>2.26  </td> <td>5   </td>\n        </tr>\n        <tr>\n            <td>2.35  </td> <td>7   </td>\n        </tr>\n        <tr>\n            <td>2.47  </td> <td>8   </td>\n        </tr>\n    </tbody>\n</table>\n<p>... (17 rows omitted)</p>","content_type":"text/html"},"text/plain":{"content":"Length | Age\n1.8    | 1\n1.85   | 1.5\n1.87   | 1.5\n1.77   | 1.5\n2.02   | 2.5\n2.27   | 4\n2.15   | 5\n2.26   | 5\n2.35   | 7\n2.47   | 8\n... (17 rows omitted)","content_type":"text/plain"}}}],"key":"VWD6ex4C2c"}],"key":"h7P0DkYy5Q"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"If we could measure the length of a dugong, what could we say about its age? Let’s examine what our data say. Here is a regression of age (the response) on length (the predictor). The correlation between the two variables is substantial, at 0.83.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"O4xrqsXwdH"}],"key":"NPtpbfcVBN"}],"key":"RQa6Rf6qJM"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"correlation(dugong, 'Length', 'Age')","key":"ecVerXnMRt"},{"type":"output","id":"RN3v609pgSQdxOTocx6eQ","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"0.8296474554905714","content_type":"text/plain"}}}],"key":"bmJxr6O8U0"}],"key":"T6qedBHtTF"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"High correlation notwithstanding, the plot shows a curved pattern that is much more visible in the residual plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"eiF6CdL9FP"}],"key":"zTMRa2AVFS"}],"key":"yi8ukgDCHB"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"regression_diagnostic_plots(dugong, 'Length', 'Age')","key":"ERDXlAJeiT"},{"type":"output","id":"cCER1TQujmRZuqpuq0WFM","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"f44c3bff25075e514ba310e8b77ce18c","path":"/build/f44c3bff25075e514ba310e8b77ce18c.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"9b056ddc3448eee2b63e3edcc3d8d701","path":"/build/9b056ddc3448eee2b63e3edcc3d8d701.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"MRE6DGwWut"}],"key":"TRBlSQAZk9"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"While you can spot the non-linearity in the original scatter, it is more clearly evident in the residual plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZDUPtqpTh2"}],"key":"SVFTnQsMX2"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"At the low end of the lengths, the residuals are almost all positive; then they are almost all negative; then positive again at the high end of lengths. In other words the regression estimates have a pattern of being too high, then too low, then too high. That means it would have been better to use a curve instead of a straight line to estimate the ages.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"ESjLntrNfZ"}],"key":"Oem0gO1Irq"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"When a residual plot shows a pattern, there may be a non-linear relation between the variables.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"EscyWwzXW0"}],"key":"IYhTVu8MBR"}],"key":"Q8ZEdJCK5W"}],"key":"rBiVGQJHE0"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Detecting Heteroscedasticity","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"TFdTdAysN1"}],"identifier":"detecting-heteroscedasticity","label":"Detecting Heteroscedasticity","html_id":"detecting-heteroscedasticity","implicit":true,"key":"pdIXCqQ8xL"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"emphasis","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Heteroscedasticity","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"YyPb0JGXKg"}],"key":"jKvTJBYt8P"},{"type":"text","value":" is a word that will surely be of interest to those who are preparing for Spelling Bees. For data scientists, its interest lies in its meaning, which is “uneven spread”.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"LSF0nu4Ugk"}],"key":"el7BnwdKWP"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Recall the table ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"tYiSinfDWS"},{"type":"inlineCode","value":"hybrid","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"B5XzdqdkKW"},{"type":"text","value":" that contains data on hybrid cars in the U.S. Here is a regression of fuel efficiency on the rate of acceleration. The association is negative: cars that accelearate quickly tend to be less efficient.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"KYbCb7lzUM"}],"key":"wDlDYwAx91"}],"key":"A8OwsveAxR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"regression_diagnostic_plots(hybrid, 'acceleration', 'mpg')","key":"FUeSP851rX"},{"type":"output","id":"g4Rp1CxMlKv4YsTvqLp3G","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"1b2ed5708afabea55e373a139bee3501","path":"/build/1b2ed5708afabea55e373a139bee3501.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}},{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"342411bc71da36bcc46c52f2d3d770df","path":"/build/342411bc71da36bcc46c52f2d3d770df.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"ulvuvZD0kI"}],"key":"JZ6yoineq8"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Notice how the residual plot flares out towards the low end of the accelerations. In other words, the variability in the size of the errors is greater for low values of acceleration than for high values. Uneven variation is often more easily noticed in a residual plot than in the original scatter plot.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"ZAmxCwgMa5"}],"key":"iPFnBpPmL4"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"If the residual plot shows uneven variation about the horizontal line at 0, the regression estimates are not equally accurate across the range of the predictor variable.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"M1KKEXsCcS"}],"key":"X8W1bXrF69"}],"key":"lnX3Zgt9MX"}],"key":"Ws6ZC0mI8y"}],"key":"JHELi2P8vO"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Least Squares Regression","url":"/chapters/15/4/least-squares-regression","group":"Computational and Inferential Thinking"},"next":{"title":"Numerical Diagnostics","url":"/chapters/15/6/numerical-diagnostics","group":"Computational and Inferential Thinking"}}},"domain":"http://localhost:3000"}