{"version":2,"kind":"Notebook","sha256":"30c7610069ced020e8c34a8452626f9c17ffae750a047b17231e95dc933286f2","slug":"chapters.15.4.least-squares-regression","location":"/chapters/15/4/Least_Squares_Regression.ipynb","dependencies":[],"frontmatter":{"title":"Least Squares Regression","content_includes_title":false,"kernelspec":{"name":"python3","display_name":"Python 3","language":"python"},"license":{"content":{"id":"CC-BY-NC-ND-4.0","url":"https://creativecommons.org/licenses/by-nc-nd/4.0/","name":"Creative Commons Attribution Non Commercial No Derivatives 4.0 International","CC":true}},"github":"https://github.com/data-8/textbook","numbering":{"title":{"enabled":true,"offset":1}},"source_url":"https://github.com/data-8/textbook/blob/main/chapters/15/4/Least_Squares_Regression.ipynb","edit_url":"https://github.com/data-8/textbook/edit/main/chapters/15/4/Least_Squares_Regression.ipynb","enumerator":"15.4","exports":[{"format":"ipynb","filename":"Least_Squares_Regression.ipynb","url":"/build/Least_Squares_Regres-c5970c48be637cb6e36f25cc3f64f061.ipynb"}]},"widgets":{},"mdast":{"type":"root","children":[{"type":"block","kind":"notebook-content","data":{"collapsed":true},"children":[{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"In an earlier section, we developed formulas for the slope and intercept of the regression line through a ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"oo4Ra7at2N"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"football shaped","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"ogB7h4s1Ig"}],"key":"kPZrpdh0dA"},{"type":"text","value":" scatter diagram. It turns out that the slope and intercept of the least squares line have the same formulas as those we developed, ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Axr2s8ihYD"},{"type":"emphasis","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"regardless of the shape of the scatter plot","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hFipEQph4x"}],"key":"U585djUuaX"},{"type":"text","value":".","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"XtuodAdmum"}],"key":"f2rqsfKgqD"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We saw this in the example about Little Women, but let’s confirm it in an example where the scatter plot clearly isn’t football shaped. For the data, we are once again indebted to the rich ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"V5oZeSR80e"},{"type":"link","url":"http://www.stat.ufl.edu/~winner/datasets.html","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"data archive of Prof. Larry Winner","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"nAZzGDGn61"}],"urlSource":"http://www.stat.ufl.edu/~winner/datasets.html","key":"C5KZ9K90gM"},{"type":"text","value":" of the University of Florida. A ","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"f573NdcLZ0"},{"type":"link","url":"http://digitalcommons.wku.edu/ijes/vol6/iss2/10/","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"2013 study","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"wxS3BNV4I1"}],"urlSource":"http://digitalcommons.wku.edu/ijes/vol6/iss2/10/","key":"aUGwWDjnEU"},{"type":"text","value":" in the International Journal of Exercise Science studied collegiate shot put athletes and examined the relation between strength and shot put distance. The population consists of 28 female collegiate athletes. Strength was measured by the the biggest amount (in kilograms) that the athlete lifted in the “1RM power clean” in the pre-season. The distance (in meters) was the athlete’s personal best.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"K3dhQKI533"}],"key":"d4ZEWl2dPh"}],"key":"ppPt8kFEQH"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"from datascience import *\n%matplotlib inline\npath_data = '../../../assets/data/'\nimport matplotlib.pyplot as plots\nplots.style.use('fivethirtyeight')\nimport numpy as np","visibility":"remove","key":"NeAfQi6IOj"},{"type":"output","id":"upjSH_x5S7_cBR8qcIph_","data":[],"visibility":"show","key":"Dn7ldxlw8m"}],"visibility":"show","key":"j13W1VfEFb"},{"type":"block","kind":"notebook-code","data":{"tags":[]},"children":[{"type":"code","lang":"python","executable":true,"value":"def standard_units(any_numbers):\n    \"Convert any array of numbers to standard units.\"\n    return (any_numbers - np.mean(any_numbers))/np.std(any_numbers)  \n\ndef correlation(t, x, y):\n    return np.mean(standard_units(t.column(x))*standard_units(t.column(y)))\n\ndef slope(table, x, y):\n    r = correlation(table, x, y)\n    return r * np.std(table.column(y))/np.std(table.column(x))\n\ndef intercept(table, x, y):\n    a = slope(table, x, y)\n    return np.mean(table.column(y)) - a * np.mean(table.column(x))\n\ndef fit(table, x, y):\n    \"\"\"Return the height of the regression line at each x value.\"\"\"\n    a = slope(table, x, y)\n    b = intercept(table, x, y)\n    return a * table.column(x) + b","visibility":"remove","key":"uMJZgJeCew"},{"type":"output","id":"4ZRx4sm6_xokQYn2RTl6V","data":[],"visibility":"show","key":"pV0oNou1NN"}],"visibility":"show","key":"H6IQOI9SgC"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"shotput = Table.read_table(path_data + 'shotput.csv')","key":"XV2jkatwgk"},{"type":"output","id":"66VOlr8Yb2wVkTTt6Ad-5","data":[],"key":"KMfVjlSIhy"}],"key":"rUtf9cKwYi"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"shotput","key":"jPn73CPlNk"},{"type":"output","id":"svJIr4V_C6-cIg1gdFH0x","data":[{"output_type":"execute_result","execution_count":4,"metadata":{},"data":{"text/html":{"content":"<table border=\"1\" class=\"dataframe\">\n    <thead>\n        <tr>\n            <th>Weight Lifted</th> <th>Shot Put Distance</th>\n        </tr>\n    </thead>\n    <tbody>\n        <tr>\n            <td>37.5         </td> <td>6.4              </td>\n        </tr>\n        <tr>\n            <td>51.5         </td> <td>10.2             </td>\n        </tr>\n        <tr>\n            <td>61.3         </td> <td>12.4             </td>\n        </tr>\n        <tr>\n            <td>61.3         </td> <td>13               </td>\n        </tr>\n        <tr>\n            <td>63.6         </td> <td>13.2             </td>\n        </tr>\n        <tr>\n            <td>66.1         </td> <td>13               </td>\n        </tr>\n        <tr>\n            <td>70           </td> <td>12.7             </td>\n        </tr>\n        <tr>\n            <td>92.7         </td> <td>13.9             </td>\n        </tr>\n        <tr>\n            <td>90.5         </td> <td>15.5             </td>\n        </tr>\n        <tr>\n            <td>90.5         </td> <td>15.8             </td>\n        </tr>\n    </tbody>\n</table>\n<p>... (18 rows omitted)</p>","content_type":"text/html"},"text/plain":{"content":"Weight Lifted | Shot Put Distance\n37.5          | 6.4\n51.5          | 10.2\n61.3          | 12.4\n61.3          | 13\n63.6          | 13.2\n66.1          | 13\n70            | 12.7\n92.7          | 13.9\n90.5          | 15.5\n90.5          | 15.8\n... (18 rows omitted)","content_type":"text/plain"}}}],"key":"nJroYva0RA"}],"key":"r7YXeI3ZRV"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"shotput.scatter('Weight Lifted')","key":"OTAw00MzIp"},{"type":"output","id":"SZXnUhkLVH6AsWblRVven","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"5898d7fb06785fc4c1380d18848f22b6","path":"/build/5898d7fb06785fc4c1380d18848f22b6.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"IkSi3VRXwq"}],"key":"ijHKFQvAV5"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"That’s not a football shaped scatter plot. In fact, it seems to have a slight non-linear component. But if we insist on using a straight line to make our predictions, there is still one best straight line among all straight lines.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"u5cHY6cRTu"}],"key":"q10YnK7Kyy"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Our formulas for the slope and intercept of the regression line, derived for football shaped scatter plots, give the following values.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"dmEHRoszQT"}],"key":"tA1Vjy1Xel"}],"key":"e0oxeQxBNz"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"slope(shotput, 'Weight Lifted', 'Shot Put Distance')","key":"Jq2NEnaYdY"},{"type":"output","id":"g9r1WPP7cr_ky-AK5L5pY","data":[{"output_type":"execute_result","execution_count":6,"metadata":{},"data":{"text/plain":{"content":"0.09834382159781997","content_type":"text/plain"}}}],"key":"nm5O4ZQAJx"}],"key":"Nssj63C1BL"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"intercept(shotput, 'Weight Lifted', 'Shot Put Distance')","key":"cv8FhLWC2y"},{"type":"output","id":"Wd_97TtMTsWsuZ-KwcMGW","data":[{"output_type":"execute_result","execution_count":7,"metadata":{},"data":{"text/plain":{"content":"5.959629098373952","content_type":"text/plain"}}}],"key":"SEOs1H8Sgf"}],"key":"aZNWuP1Ubm"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Does it still make sense to use these formulas even though the scatter plot isn’t football shaped? We can answer this by finding the slope and intercept of the line that minimizes the mse.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"F7qNMytkZP"}],"key":"mfXAYbpuY9"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"We will define the function ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"exatVmNZxa"},{"type":"inlineCode","value":"shotput_linear_mse","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"QBfaqf78hr"},{"type":"text","value":" to take an arbirtary slope and intercept as arguments and return the corresponding mse. Then ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"SEpWbT0H5Q"},{"type":"inlineCode","value":"minimize","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"J6VqCTDsDC"},{"type":"text","value":" applied to ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"nh5AMRbbPt"},{"type":"inlineCode","value":"shotput_linear_mse","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kwjZoLtME2"},{"type":"text","value":" will return the best slope and intercept.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"OfG0sEzJd8"}],"key":"jTMCu2sYdu"}],"key":"iKFC4pqlYk"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def shotput_linear_mse(any_slope, any_intercept):\n    x = shotput.column('Weight Lifted')\n    y = shotput.column('Shot Put Distance')\n    fitted = any_slope*x + any_intercept\n    return np.mean((y - fitted) ** 2)","key":"dSEejO187c"},{"type":"output","id":"0vrK-WojJAo54L0OdbKCh","data":[],"key":"mQurq5aUfA"}],"key":"TzmfR1WitR"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"minimize(shotput_linear_mse)","key":"nzGzSjfR61"},{"type":"output","id":"VPIRCFzy9IIoVntYYw6Mc","data":[{"output_type":"execute_result","execution_count":9,"metadata":{},"data":{"text/plain":{"content":"array([0.09834382, 5.95962911])","content_type":"text/plain"}}}],"key":"UDHhXEdwx5"}],"key":"IpZFsCP28r"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"These values are the same as those we got by using our formulas. To summarize:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Jt1274m0fO"}],"key":"WPYk9MR0jn"},{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"No matter what the shape of the scatter plot, there is a unique line that minimizes the mean squared error of estimation. It is called the regression line, and its slope and intercept are given by","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"kTngss3AcM"}],"key":"egYpPcXf7n"}],"key":"r6FEdiDpbQ"},{"type":"math","value":"\\mathbf{\\mbox{slope of the regression line}} ~=~ r \\cdot\n\\frac{\\mbox{SD of }y}{\\mbox{SD of }x}","position":{"start":{"line":5,"column":1},"end":{"line":8,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>slope of the regression line </mtext><mo>=</mo><mtext> </mtext><mi>r</mi><mo>⋅</mo><mfrac><mrow><mtext>SD of </mtext><mi>y</mi></mrow><mrow><mtext>SD of </mtext><mi>x</mi></mrow></mfrac></mrow><annotation encoding=\"application/x-tex\">\\mathbf{\\mbox{slope of the regression line}} ~=~ r \\cdot\n\\frac{\\mbox{SD of }y}{\\mbox{SD of }x}</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">slope of the regression line</span></span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.02778em;\">r</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:2.0574em;vertical-align:-0.686em;\"></span><span class=\"mord\"><span class=\"mopen nulldelimiter\"></span><span class=\"mfrac\"><span class=\"vlist-t vlist-t2\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:1.3714em;\"><span style=\"top:-2.314em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">SD of </span></span><span class=\"mord mathnormal\">x</span></span></span><span style=\"top:-3.23em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"frac-line\" style=\"border-bottom-width:0.04em;\"></span></span><span style=\"top:-3.677em;\"><span class=\"pstrut\" style=\"height:3em;\"></span><span class=\"mord\"><span class=\"mord text\"><span class=\"mord\">SD of </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span></span></span></span><span class=\"vlist-s\">​</span></span><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.686em;\"><span></span></span></span></span></span><span class=\"mclose nulldelimiter\"></span></span></span></span></span></span>","enumerator":"1","key":"qhajgubzD1"},{"type":"math","value":"\\mathbf{\\mbox{intercept of the regression line}} ~=~\n\\mbox{average of }y ~-~ \\mbox{slope} \\cdot \\mbox{average of }x","position":{"start":{"line":10,"column":1},"end":{"line":13,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mtext>intercept of the regression line </mtext><mo>=</mo><mtext> average of </mtext><mi>y</mi><mtext> </mtext><mo>−</mo><mtext> slope</mtext><mo>⋅</mo><mtext>average of </mtext><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">\\mathbf{\\mbox{intercept of the regression line}} ~=~\n\\mbox{average of }y ~-~ \\mbox{slope} \\cdot \\mbox{average of }x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">intercept of the regression line</span></span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord text\"><span class=\"mord\">average of </span></span><span class=\"mord mathnormal\" style=\"margin-right:0.03588em;\">y</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord text\"><span class=\"mord\">slope</span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">⋅</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.8889em;vertical-align:-0.1944em;\"></span><span class=\"mord text\"><span class=\"mord\">average of </span></span><span class=\"mord mathnormal\">x</span></span></span></span></span>","enumerator":"2","key":"Byr8PvKIsk"}],"key":"WOAdUXSWci"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"fitted = fit(shotput, 'Weight Lifted', 'Shot Put Distance')\nshotput.with_column('Best Straight Line', fitted).scatter('Weight Lifted')","key":"chewIbQQfx"},{"type":"output","id":"MKDAS616s-Iy-RgNhUk3G","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"088b8ee8a0d5121f56407c5451b27ec0","path":"/build/088b8ee8a0d5121f56407c5451b27ec0.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"oChbhoLxVx"}],"key":"sfE5rLBGfW"},{"type":"block","kind":"notebook-content","children":[{"type":"heading","depth":2,"position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Nonlinear Regression","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pEXEKWYph5"}],"identifier":"nonlinear-regression","label":"Nonlinear Regression","html_id":"nonlinear-regression","implicit":true,"key":"j7lmyAFy0L"},{"type":"paragraph","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"The graph above reinforces our earlier observation that the scatter plot is a bit curved. So it is better to fit a curve than a straight line. The ","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"hLDjFm0DLn"},{"type":"link","url":"http://digitalcommons.wku.edu/ijes/vol6/iss2/10/","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"children":[{"type":"text","value":"study","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"Grf8SA6pFF"}],"urlSource":"http://digitalcommons.wku.edu/ijes/vol6/iss2/10/","key":"HDmoS3tfIi"},{"type":"text","value":" postulated a quadratic relation between the weight lifted and the shot put distance. So let’s use quadratic functions as our predictors and see if we can find the best one.","position":{"start":{"line":2,"column":1},"end":{"line":2,"column":1}},"key":"slAQ0bsPcn"}],"key":"ObED5omPCn"},{"type":"paragraph","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"children":[{"type":"text","value":"We have to find the best quadratic function among all quadratic functions, instead of the best straight line among all straight lines. The method of least squares allows us to do this.","position":{"start":{"line":4,"column":1},"end":{"line":4,"column":1}},"key":"MeVszKwPah"}],"key":"NEg2puSSL9"},{"type":"paragraph","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"The mathematics of this minimization is complicated and not easy to see just by examining the scatter plot. But numerical minimization is just as easy as it was with linear predictors! We can get the best quadratic predictor by once again using ","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"Vs0aE3hZN7"},{"type":"inlineCode","value":"minimize","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"VkcloDegIF"},{"type":"text","value":". Let’s see how this works.","position":{"start":{"line":6,"column":1},"end":{"line":6,"column":1}},"key":"osJjoWm197"}],"key":"TDZt4L7kXQ"}],"key":"wmImMQkSGH"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Recall that a quadratic function has the form","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"wHPl3duOTR"}],"key":"BqD3TtsiC6"},{"type":"math","value":"f(x) ~=~ ax^2 + bx + c","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mi>f</mi><mo stretchy=\"false\">(</mo><mi>x</mi><mo stretchy=\"false\">)</mo><mtext> </mtext><mo>=</mo><mtext> </mtext><mi>a</mi><msup><mi>x</mi><mn>2</mn></msup><mo>+</mo><mi>b</mi><mi>x</mi><mo>+</mo><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">f(x) ~=~ ax^2 + bx + c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:1.1141em;vertical-align:-0.25em;\"></span><span class=\"mord mathnormal\" style=\"margin-right:0.10764em;\">f</span><span class=\"mopen\">(</span><span class=\"mord mathnormal\">x</span><span class=\"mclose\">)</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mrel\">=</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2778em;\"></span><span class=\"mord mathnormal\">a</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.7778em;vertical-align:-0.0833em;\"></span><span class=\"mord mathnormal\">b</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span></span>","enumerator":"3","key":"WPd3l8zKf0"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"for constants ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"MGGuKbON2v"},{"type":"inlineMath","value":"a","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>a</mi></mrow><annotation encoding=\"application/x-tex\">a</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">a</span></span></span></span>","key":"k3FJZikMLd"},{"type":"text","value":", ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"nVT6EYTcAY"},{"type":"inlineMath","value":"b","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>b</mi></mrow><annotation encoding=\"application/x-tex\">b</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.6944em;\"></span><span class=\"mord mathnormal\">b</span></span></span></span>","key":"sxFgurhFld"},{"type":"text","value":", and ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"TGC0hM2Hzh"},{"type":"inlineMath","value":"c","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>c</mi></mrow><annotation encoding=\"application/x-tex\">c</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">c</span></span></span></span>","key":"f7jH0VhdJB"},{"type":"text","value":".","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"EYu129LMBz"}],"key":"NxJbgU1CAN"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"To find the best quadratic function to predict distance based on weight lifted, using the criterion of least squares, we will first write a function that takes the three constants as its arguments, calculates the fitted values by using the quadratic function above, and then returns the mean squared error.","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"iRX9KXh5Id"}],"key":"qfZItGDC1J"},{"type":"paragraph","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"The function is called ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"h9IQMoeVNd"},{"type":"inlineCode","value":"shotput_quadratic_mse","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"LnWBye7aeo"},{"type":"text","value":". Notice that the definition is analogous to that of ","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"g4EuO3139h"},{"type":"inlineCode","value":"lw_mse","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"XJ7yKKxzXd"},{"type":"text","value":", except that the fitted values are based on a quadratic function instead of linear.","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"ZjFbpS8tsC"}],"key":"v6M1xOAm85"}],"key":"l8Elb4gO5z"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"def shotput_quadratic_mse(a, b, c):\n    x = shotput.column('Weight Lifted')\n    y = shotput.column('Shot Put Distance')\n    fitted = a*(x**2) + b*x + c\n    return np.mean((y - fitted) ** 2)","key":"LUdWB2tUhH"},{"type":"output","id":"ZXmlVrKJgSp_LRM9Rq18E","data":[],"key":"ULYr2eLx2t"}],"key":"DmAhXe9iOb"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"We can now use ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jEX9vUoCRl"},{"type":"inlineCode","value":"minimize","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"aXKfRW0ewM"},{"type":"text","value":" just as before to find the constants that minimize the mean squared error.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"pAnxNKFxHW"}],"key":"JkEp2n3yjs"}],"key":"WyDmQXhFy4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"best = minimize(shotput_quadratic_mse)\nbest","key":"mYQsQhx1IJ"},{"type":"output","id":"cOtx21RZSratZjzKkhU5T","data":[{"output_type":"execute_result","execution_count":12,"metadata":{},"data":{"text/plain":{"content":"array([-1.04004838e-03,  2.82708045e-01, -1.53182115e+00])","content_type":"text/plain"}}}],"key":"r7oBsTbep4"}],"key":"VJ3o5xMvb7"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Our prediction of the shot put distance for an athlete who lifts ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"SMWHN2zz20"},{"type":"inlineMath","value":"x","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"html":"<span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\"><semantics><mrow><mi>x</mi></mrow><annotation encoding=\"application/x-tex\">x</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.4306em;\"></span><span class=\"mord mathnormal\">x</span></span></span></span>","key":"UmRALngkNp"},{"type":"text","value":" kilograms is about","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Z3H9zcoOlC"}],"key":"LyALQGr2xw"},{"type":"math","value":"-0.00104x^2 ~+~ 0.2827x - 1.5318","position":{"start":{"line":3,"column":1},"end":{"line":5,"column":1}},"html":"<span class=\"katex-display\"><span class=\"katex\"><span class=\"katex-mathml\"><math xmlns=\"http://www.w3.org/1998/Math/MathML\" display=\"block\"><semantics><mrow><mo>−</mo><mn>0.00104</mn><msup><mi>x</mi><mn>2</mn></msup><mtext> </mtext><mo>+</mo><mtext> </mtext><mn>0.2827</mn><mi>x</mi><mo>−</mo><mn>1.5318</mn></mrow><annotation encoding=\"application/x-tex\">-0.00104x^2 ~+~ 0.2827x - 1.5318</annotation></semantics></math></span><span class=\"katex-html\" aria-hidden=\"true\"><span class=\"base\"><span class=\"strut\" style=\"height:0.9474em;vertical-align:-0.0833em;\"></span><span class=\"mord\">−</span><span class=\"mord\">0.00104</span><span class=\"mord\"><span class=\"mord mathnormal\">x</span><span class=\"msupsub\"><span class=\"vlist-t\"><span class=\"vlist-r\"><span class=\"vlist\" style=\"height:0.8641em;\"><span style=\"top:-3.113em;margin-right:0.05em;\"><span class=\"pstrut\" style=\"height:2.7em;\"></span><span class=\"sizing reset-size6 size3 mtight\"><span class=\"mord mtight\">2</span></span></span></span></span></span></span></span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">+</span><span class=\"mspace nobreak\"> </span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mord\">0.2827</span><span class=\"mord mathnormal\">x</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span><span class=\"mbin\">−</span><span class=\"mspace\" style=\"margin-right:0.2222em;\"></span></span><span class=\"base\"><span class=\"strut\" style=\"height:0.6444em;\"></span><span class=\"mord\">1.5318</span></span></span></span></span>","enumerator":"4","key":"ur3zjvwZ49"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"meters. For example, if the athlete can lift 100 kilograms, the predicted distance is 16.33 meters. On the scatter plot, that’s near the center of a vertical strip around 100 kilograms.","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"ESZegsGWAG"}],"key":"AJjhmzyI7L"}],"key":"l7d6ixpDK4"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"(-0.00104)*(100**2) + 0.2827*100 - 1.5318","key":"VxV2Zr7f2q"},{"type":"output","id":"ADS3Uu4W8W_g1tFGPABo3","data":[{"output_type":"execute_result","execution_count":13,"metadata":{},"data":{"text/plain":{"content":"16.3382","content_type":"text/plain"}}}],"key":"GCGLotvcgk"}],"key":"cCAAD3ap5a"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Here are the predictions for all the values of ","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nFkLnIYxcq"},{"type":"inlineCode","value":"Weight Lifted","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"nYO35bw7qB"},{"type":"text","value":". You can see that they go through the center of the scatter plot, to a rough approximation.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"jR3vuMac86"}],"key":"ZA3RYZFZKM"}],"key":"QnKAaZwpSm"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"x = shotput.column(0)\nshotput_fit = best.item(0)*(x**2) + best.item(1)*x + best.item(2)","key":"b6mDsBIgWj"},{"type":"output","id":"CZ98iP5d9ePohNq2OO21O","data":[],"key":"xSSZBswjrX"}],"key":"hIBOtjdoVq"},{"type":"block","kind":"notebook-code","children":[{"type":"code","lang":"python","executable":true,"value":"shotput.with_column('Best Quadratic Curve', shotput_fit).scatter(0)","key":"O7OdWxNgkL"},{"type":"output","id":"KL0kN1kIg1-z-rPfDbreJ","data":[{"output_type":"display_data","metadata":{},"data":{"image/png":{"content_type":"image/png","hash":"c1829ffe85c3e9a93708487603225b17","path":"/build/c1829ffe85c3e9a93708487603225b17.png"},"text/plain":{"content":"<Figure size 360x360 with 1 Axes>","content_type":"text/plain"}}}],"key":"vLY2gCtUgS"}],"key":"XbAprPcwLt"},{"type":"block","kind":"notebook-content","children":[{"type":"paragraph","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"strong","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"children":[{"type":"text","value":"Note:","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"oTd8MYofry"}],"key":"FOlpctmx9F"},{"type":"text","value":" We fit a quadratic here because it was suggested in the original study. But it is worth noting that at the rightmost end of the graph, the quadratic curve appears to be close to peaking, after which the curve will start going downwards. So we might not want to use this model for new athletes who can lift weights much higher than those in our data set.","position":{"start":{"line":1,"column":1},"end":{"line":1,"column":1}},"key":"Mf1vxR9w6T"}],"key":"jnOne5r0pH"}],"key":"nBpwr33UJ2"}],"key":"o9Aj3y9ad3"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"The Method of Least Squares","url":"/chapters/15/3/method-of-least-squares","group":"Computational and Inferential Thinking"},"next":{"title":"Visual Diagnostics","url":"/chapters/15/5/visual-diagnostics","group":"Computational and Inferential Thinking"}}},"domain":"http://localhost:3000"}